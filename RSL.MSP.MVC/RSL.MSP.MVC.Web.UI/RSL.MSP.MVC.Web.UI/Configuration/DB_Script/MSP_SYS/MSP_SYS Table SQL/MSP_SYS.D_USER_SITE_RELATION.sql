/* Formatted on 2015/12/14 20:04:17 (QP5 v5.136.908.31019) */
DROP TABLE MSP_SYS.D_USER_SITE_RELATION CASCADE CONSTRAINTS;

CREATE TABLE MSP_SYS.D_USER_SITE_RELATION
(
   RELATION_ID     NUMBER NOT NULL,
   USER_ID         NUMBER NOT NULL,
   SITE_ID         VARCHAR2 (12 BYTE) NOT NULL,
   IS_VALID        INTEGER,
   CREATE_DATE     DATE NOT NULL,
   CREATE_BY       VARCHAR2 (20 BYTE) NOT NULL,
   LASTEDIT_DATE   DATE,
   LASTEDIT_BY     VARCHAR2 (20 BYTE)
)
TABLESPACE MSP_SYS_DAT
PCTUSED 0
PCTFREE 10
INITRANS 1
MAXTRANS 255
STORAGE (INITIAL 1 M
         NEXT 1 M
         MINEXTENTS 1
         MAXEXTENTS UNLIMITED
         PCTINCREASE 0
         BUFFER_POOL DEFAULT)
LOGGING
NOCOMPRESS
NOCACHE
NOPARALLEL
MONITORING;

COMMENT ON TABLE MSP_SYS.D_USER_SITE_RELATION IS '用户分店关系表';

COMMENT ON COLUMN MSP_SYS.D_USER_SITE_RELATION.RELATION_ID IS '关系ID';

COMMENT ON COLUMN MSP_SYS.D_USER_SITE_RELATION.USER_ID IS '用户ID';

COMMENT ON COLUMN MSP_SYS.D_USER_SITE_RELATION.SITE_ID IS '分店ID';

COMMENT ON COLUMN MSP_SYS.D_USER_SITE_RELATION.IS_VALID IS '关系是否有效，1有效；0，无效；';

COMMENT ON COLUMN MSP_SYS.D_USER_SITE_RELATION.CREATE_DATE IS '创建日期';

COMMENT ON COLUMN MSP_SYS.D_USER_SITE_RELATION.CREATE_BY IS '修改人';

COMMENT ON COLUMN MSP_SYS.D_USER_SITE_RELATION.LASTEDIT_DATE IS '最后修改时间';

COMMENT ON COLUMN MSP_SYS.D_USER_SITE_RELATION.LASTEDIT_BY IS '最后修改人';


CREATE UNIQUE INDEX MSP_SYS.D_USER_SITE_RELATION_PK
   ON MSP_SYS.D_USER_SITE_RELATION (RELATION_ID)
   LOGGING
   TABLESPACE MSP_SYS_DAT
   PCTFREE 10
   INITRANS 2
   MAXTRANS 255
   STORAGE (INITIAL 1 M
            NEXT 1 M
            MINEXTENTS 1
            MAXEXTENTS UNLIMITED
            PCTINCREASE 0
            BUFFER_POOL DEFAULT)
   NOPARALLEL;


CREATE SEQUENCE MSP_SYS.SEQ_D_USER_SITE_RELATION
   START WITH 6
   MAXVALUE 999999999999999999999999999
   MINVALUE 1
   NOCYCLE
   NOCACHE
   NOORDER;



CREATE OR REPLACE TRIGGER MSP_SYS.TR_D_USER_SITE_RELATION
   BEFORE INSERT
   ON MSP_SYS.D_USER_SITE_RELATION
   FOR EACH ROW
BEGIN
   SELECT SEQ_D_USER_SITE_RELATION.NEXTVAL INTO :NEW.RELATION_ID FROM DUAL;
END TR_D_USER_SITE_RELATION;
